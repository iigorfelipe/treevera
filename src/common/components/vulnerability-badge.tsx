import { cn } from "@/common/utils/cn";
import { Badge } from "./ui/badge";
import { useTranslation } from "react-i18next";

export type StatusCode =
  | "EX"
  | "EW"
  | "CR"
  | "EN"
  | "VU"
  | "NT"
  | "LC"
  | "DD"
  | "NE";

const STATUS_STYLE: Record<StatusCode, { bg: string; text?: string }> = {
  EX: { bg: "bg-gray-800" },
  EW: { bg: "bg-gray-600" },
  CR: { bg: "bg-red-700" },
  EN: { bg: "bg-orange-600" },
  VU: { bg: "bg-yellow-500", text: "text-black" },
  NT: { bg: "bg-lime-500", text: "text-black" },
  LC: { bg: "bg-green-500" },
  DD: { bg: "bg-blue-400" },
  NE: { bg: "bg-neutral-400" },
};

interface VulnerabilityBadgeProps {
  statusCode?: StatusCode | null;
}

export const VulnerabilityBadge = ({ statusCode }: VulnerabilityBadgeProps) => {
  const { t } = useTranslation();

  if (!statusCode || !(statusCode in STATUS_STYLE)) {
    return (
      <Badge className="w-full bg-neutral-500 py-3 text-sm text-white">
        {t("vulnerability.unknown")}
      </Badge>
    );
  }

  const { bg, text } = STATUS_STYLE[statusCode];

  return (
    <Badge className={cn("w-full py-3 text-sm text-white", bg, text)}>
      {t(`vulnerability.${statusCode}`)}
    </Badge>
  );
};
